<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=/images/LTS.png><title>Utilizing the Contents of a SharePoint Image Column Elsewhere - Lindsay T Shelton</title><meta name=description content="So I recently met with someone who had a conundrum. They had a SharePoint list with an Image type column, relatively new-ish, and they wanted to post the contents of this column to Teams on a regular cadence, along with other text column content. They had tried every dynamic content option related to the Image column in Power Automate and nothing was working. I found quite a few blog posts that got us close, but not all the way."><meta name=author content="Lindsay Shelton"><meta name=generator content="Hugo 0.108.0"><link rel=stylesheet href="https://blist.vercel.app/css/styles.min.c0846aac9db6c87efe354bad93a5e4432ef35cc12598aeed07df50323381cc06.css" integrity="sha256-wIRqrJ22yH7+NUutk6XkQy7zXMElmK7tB99QMjOBzAY="><meta property="og:title" content="Utilizing the Contents of a SharePoint Image Column Elsewhere"><meta property="og:description" content="So I recently met with someone who had a conundrum. They had a SharePoint list with an Image type column, relatively new-ish, and they wanted to post the contents of this column to Teams on a regular cadence, along with other text column content. They had tried every dynamic content option related to the Image column in Power Automate and nothing was working. I found quite a few blog posts that got us close, but not all the way."><meta property="og:type" content="article"><meta property="og:url" content="https://blist.vercel.app/blog/202302utilizing-the-contents-of-a-sharepoint-image-column-elsewhere/"><meta property="article:section" content="blog"><meta property="article:published_time" content="2023-02-27T14:49:05-05:00"><meta property="article:modified_time" content="2023-02-27T14:49:05-05:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Utilizing the Contents of a SharePoint Image Column Elsewhere"><meta name=twitter:description content="So I recently met with someone who had a conundrum. They had a SharePoint list with an Image type column, relatively new-ish, and they wanted to post the contents of this column to Teams on a regular cadence, along with other text column content. They had tried every dynamic content option related to the Image column in Power Automate and nothing was working. I found quite a few blog posts that got us close, but not all the way."><meta itemprop=name content="Utilizing the Contents of a SharePoint Image Column Elsewhere"><meta itemprop=description content="So I recently met with someone who had a conundrum. They had a SharePoint list with an Image type column, relatively new-ish, and they wanted to post the contents of this column to Teams on a regular cadence, along with other text column content. They had tried every dynamic content option related to the Image column in Power Automate and nothing was working. I found quite a few blog posts that got us close, but not all the way."><meta itemprop=datePublished content="2023-02-27T14:49:05-05:00"><meta itemprop=dateModified content="2023-02-27T14:49:05-05:00"><meta itemprop=wordCount content="1153"><meta itemprop=keywords content="sharepoint,power automate,"></head><body class="dark:bg-gray-800 dark:text-white relative flex flex-col min-h-screen"><header class="container flex justify-between md:justify-between gap-4 flex-wrap p-6 mx-auto relative"><a href=https://blist.vercel.app/ class="capitalize font-extrabold text-2xl"><img src=/images/LTS2.png alt="Lindsay T Shelton" class="h-8 max-w-full"></a>
<button class="mobile-menu-button md:hidden"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><line x1="4" y1="8" x2="20" y2="8"/><line x1="4" y1="16" x2="20" y2="16"/></svg></button><ul class="mobile-menu absolute z-10 px-6 pb-6 md:p-0 top-full left-0 w-full md:w-auto md:relative hidden md:flex flex-col md:flex-row items-end md:items-center gap-4 lg:gap-6 bg-white dark:bg-gray-800"><li><a href=/blog>Blog</a></li><li><a href=/page/about/>About</a></li><li><a href=/tags>Tags</a></li><li class="grid place-items-center"><span class="open-search inline-block cursor-pointer"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg></span></li><li class="grid place-items-center"><span class="toggle-dark-mode inline-block cursor-pointer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="12" cy="12" r="3"/><line x1="12" y1="5" x2="12" y2="5.01"/><line x1="17" y1="7" x2="17" y2="7.01"/><line x1="19" y1="12" x2="19" y2="12.01"/><line x1="17" y1="17" x2="17" y2="17.01"/><line x1="12" y1="19" x2="12" y2="19.01"/><line x1="7" y1="17" x2="7" y2="17.01"/><line x1="5" y1="12" x2="5" y2="12.01"/><line x1="7" y1="7" x2="7" y2="7.01"/></svg></span></li></ul></header><main class=flex-1><article class="prose lg:prose-lg mx-auto my-8 dark:prose-dark px-4"><h1 class="text-2xl font-bold mb-2">Utilizing the Contents of a SharePoint Image Column Elsewhere</h1><h5 class="text-sm flex items-center flex-wrap"><svg xmlns="http://www.w3.org/2000/svg" class="mr-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><rect x="4" y="5" width="16" height="16" rx="2"/><line x1="16" y1="3" x2="16" y2="7"/><line x1="8" y1="3" x2="8" y2="7"/><line x1="4" y1="11" x2="20" y2="11"/><rect x="8" y="15" width="2" height="2"/></svg>Posted on
February 27, 2023
&nbsp;&bull;&nbsp;<svg xmlns="http://www.w3.org/2000/svg" class="mr-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
6&nbsp;minutes
&nbsp;&bull;<svg xmlns="http://www.w3.org/2000/svg" class="mx-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 19a9 9 0 019 0 9 9 0 019 0"/><path d="M3 6a9 9 0 019 0 9 9 0 019 0"/><line x1="3" y1="6" x2="3" y2="19"/><line x1="12" y1="6" x2="12" y2="19"/><line x1="21" y1="6" x2="21" y2="19"/></svg>
1153&nbsp;words</h5><details id=TableOfContents class="px-4 mt-4 bg-gray-100 dark:bg-gray-700 rounded toc"><summary class="flex items-center font-bold py-2 px-4 cursor-pointer justify-between select-none text-black dark:text-white"><span>Table of contents</span><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-down" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><polyline points="6 9 12 15 18 9"/></svg></summary><ul class="mt-2 pb-4"><li><a href=#the-sharepoint-list>The SharePoint List</a></li><li><a href=#the-power-automate-flow>The Power Automate Flow</a></li><li><a href=#teams-adaptive-cards>Teams Adaptive Cards</a></li></ul></details><p>So I recently met with someone who had a conundrum. They had a SharePoint list with an Image type column, relatively new-ish, and they wanted to post the contents of this column to Teams on a regular cadence, along with other text column content. They had tried every dynamic content option related to the Image column in Power Automate and nothing was working. I found quite a few blog posts that got us close, but not all the way. An hour or two later led to this…</p><h2 id=the-sharepoint-list>The SharePoint List</h2><p>Just to be thorough, we are talking about a SharePoint list with this type of column:</p><p><img src=/images/utilizing-the-contents-of-a-sharepoint-image-column-elsewhere1.png alt=Placeholder></p><p>If you aren’t sure if you are working with an Image column, when viewing List Settings, it says the Type is “Thumbnail”:</p><p><img src=/images/utilizing-the-contents-of-a-sharepoint-image-column-elsewhere2.png alt=Placeholder></p><p>So, I built a SharePoint list just for the sake of testing. This isn’t the actual use case, so expect cats.</p><h2 id=the-power-automate-flow>The Power Automate Flow</h2><p>I built a flow with a “When an item is created” trigger, and threw a “Get item” block on there as well, tied to my new SharePoint list.</p><p><img src=/images/utilizing-the-contents-of-a-sharepoint-image-column-elsewhere3.png alt=Placeholder></p><p>Now we start getting fancy. Add a “Send an HTTP request to SharePoint” block, and you are going to put in the following code for the Uri:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>_api/lists/getbytitle(&#39;ListNameWith%20For%20Spaces&#39;)/items(@{outputs(&#39;Get_item&#39;)?[&#39;body/ID&#39;]})/ColumnName
</span></span></code></pre></div><p>The parts you need to change are in bold. Your list name goes in the parens and single quotes with %20 if you have spaces. So, with my example, my actual list name would be ListNameWith For Spaces. What you put after the last backslash is the name of your image column.</p><p>Here’s a slightly more readable version:</p><p><img src=/images/utilizing-the-contents-of-a-sharepoint-image-column-elsewhere4.png alt=Placeholder></p><p>My list name is List With Images (note the spaces). My image column is named ImageColumn. The ID is just dynamic content – the ID for “Get item” or “When an item is created” (they should be the same).</p><p>Now, you will need to run your flow as you build to help you do each next step. Run your flow now and copy/paste the output of the Send an HTTP request to SharePoint action. It’s going to look short and funny.</p><p><img src=/images/utilizing-the-contents-of-a-sharepoint-image-column-elsewhere5.png alt=Placeholder></p><p>Create a new Parse JSON block. For the body, put the “body” dynamic content from Send an HTTP request to SharePoint. Then click “Generate from sample” at the bottom of the new block.</p><p>Paste in the JSON (the output) from the run into the box where it says “Insert a sample JSON Payload”. It should look like this:</p><p><img src=/images/utilizing-the-contents-of-a-sharepoint-image-column-elsewhere6.png alt=Placeholder></p><p>Then click “Done”. There will now be a formatted JSON schema for you in the Parse JSON box.</p><p><img src=/images/utilizing-the-contents-of-a-sharepoint-image-column-elsewhere7.png alt=Placeholder></p><p>Run the flow again.</p><p>(Yes, there are probably easier ways to do this, but this is what I got working – the story of my life).</p><p>Now open your Parse JSON block after the run and look at the Outputs. It should look basically like what your output looked like before (which leaves me questioning again if we need this step, but I shall carry on).</p><p>Now, we are going to copy/paste again, but just copying and pasting a very specific part of the output:</p><p><img src=/images/utilizing-the-contents-of-a-sharepoint-image-column-elsewhere8.png alt=Placeholder></p><p>So, just the curly brace right before and right after the ImageColumn row and everything in the middle (your row will be called whatever your column is called).</p><p>Make another Parse JSON block. The body? It should be the ImageColumn dynamic content from the first Parse JSON block. In case yours doesn’t come across preoprly, here’s the expression you can write to get it, replacing “ImageColumn” with whatever you named that column:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>body(&#39;Parse_JSON&#39;)?[&#39;d&#39;]?[&#39;ImageColumn&#39;]
</span></span></code></pre></div><p>When you click “Generate from sample” again, this time we are just pasting in the shorter JSON that just includes the two curly braces in front and in back and the ImageColumn row.</p><p>When you click Done, your JSON schema should look like this:</p><p><img src=/images/utilizing-the-contents-of-a-sharepoint-image-column-elsewhere9.png alt=Placeholder></p><p>Now, here’s where the Choose Your Own Adventure comes in. I chose to use an adaptive card to post in Teams. You could probably choose to do all sorts of things with this – know that what you get out of the second Parse JSON action is the following info:</p><p>{</p><p>“type”: “thumbnail”,</p><p>“fileName”: “buffy5x7.png”,</p><p>“nativeFile”: {},</p><p>“fieldName”: “ImageColumn”,</p><p>“serverUrl”: “https://lindsaytshelton.sharepoint.com”,</p><p>“fieldId”: “5ea0b5e7-7385-403c-b18b-29dcca3c8761”,</p><p>“serverRelativeUrl”: “/sites/Home/SiteAssets/Lists/f41aff47-f53f-40c6-b3ff-663c5cbbef0d/buffy5x7.png”,</p><p>“id”: “065e6ca1-7683-47ab-bb64-a50b8d66e9e2”</p><p>}</p><p>What will likely be the most useful to you is the serverUrl paired with the serverRelativeUrl, and that’s what I’m going to use. Keep scrolling for the code block if that’s all you need, but know that I’m going to go into a bit of high level Adaptive Card Designer stuff.</p><h2 id=teams-adaptive-cards>Teams Adaptive Cards</h2><p>So, I hustled myself over to the <a href=https://adaptivecards.io/designer/>Adaptive Card Designer</a> and proceeded to strip out everything I didn’t need by clicking an element and clicking the X in the corner.</p><p><img src=/images/utilizing-the-contents-of-a-sharepoint-image-column-elsewhere10.png alt=Placeholder></p><p>I then just used the Card Elements on the left and dragged them into the visual designer area until I had an image block and a text block.</p><p>Here are a few hints from a very infrequent user:</p><ul><li>Leave the Title text box alone so that you can see how one is formatted (size and weight are added to the JSON down below)</li><li>Strip out the empty columns that are there too – keep it simple for your first one</li><li>If you want an image still there so you have sort of a visual, click the empty Image box and click “Bind”. Then click the “profileImage” option and you get this nice looking man taking up a huge part of your card. Don’t worry, the card scales to how big the image is.</li><li>At the very top, where it says “Select host app”, change it to Microsoft Teams so you can see the subtle difference</li><li>Down below where you see “Card payload editor”, change what is in “text”: “___” to something helpful to you. You will see what I changed mine too shortly.</li></ul><p>All I needed was a title and an image, so I was ready. If that’s all that you need, I’ll just give you my JSON.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>{
</span></span><span style=display:flex><span>    &#34;type&#34;: &#34;AdaptiveCard&#34;,
</span></span><span style=display:flex><span>    &#34;body&#34;: [
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            &#34;type&#34;: &#34;TextBlock&#34;,
</span></span><span style=display:flex><span>            &#34;size&#34;: &#34;Medium&#34;,
</span></span><span style=display:flex><span>            &#34;weight&#34;: &#34;Bolder&#34;,
</span></span><span style=display:flex><span>            &#34;text&#34;: &#34;PUT TITLE HERE&#34;
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            &#34;type&#34;: &#34;Image&#34;,
</span></span><span style=display:flex><span>            &#34;url&#34;: &#34;${$root.creator.profileImage}&#34;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    ],
</span></span><span style=display:flex><span>    &#34;$schema&#34;: &#34;http://adaptivecards.io/schemas/adaptive-card.json&#34;,
</span></span><span style=display:flex><span>    &#34;version&#34;: &#34;1.4&#34;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Add a new block, Post adaptive card in a chat or channel, and configure the options to your liking.</p><p>Where it says “Adaptive card”, that’s where you will now paste your JSON and edit it with your dynamic content.</p><p><img src=/images/utilizing-the-contents-of-a-sharepoint-image-column-elsewhere11.png alt=Placeholder></p><p>When you have “text”: “___”, you can put dynamic content right in between the second set of quotation marks, like I’ve done with my title field.</p><p>As for the “url” for my Image field, here’s the two expressions I had to type in. Modify based on your block name (if you change it to be something better than Parse JSON 2):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>body(&#39;Parse_JSON_2&#39;)?[&#39;serverUrl&#39;]
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>body(&#39;Parse_JSON_2&#39;)?[&#39;serverRelativeUrl&#39;]
</span></span></code></pre></div><p>Make sure there are no spaces between the two and that they are placed between the second set of quotation marks, so “url”: “serverUrlserverRelativeUrl” if I was just writing it out.</p><p>Run it, and hopefully, voila!</p><p><img src=/images/utilizing-the-contents-of-a-sharepoint-image-column-elsewhere12.png alt=Placeholder></p><script async src="https://www.googletagmanager.com/gtag/js?id=G-CN3PDT3T20"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-CN3PDT3T20")</script><blockquote></blockquote></article><div class="px-2 mb-2"><script src=https://giscus.app/client.js data-repo data-repo-id data-category data-category-id data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=en crossorigin=anonymous async></script></div><div class="bg-pink-100 dark:bg-gray-900"><div class="container px-4 py-12 mx-auto max-w-4xl grid grid-cols-1 md:grid-cols-2 gap-4 items-center"><div><div class="text-2xl font-bold mb-2">Follow me</div><p class=opacity-60>Follow along for Power Platform, M365, and cat goodness</p></div><ul class="flex justify-center gap-x-3 flex-wrap gap-y-2"><li><a href=https://linkedin.com/in/lindsaytshelton target=_blank rel=noopener aria-label=LinkedIn class="p-1 inline-block rounded-full border border-transparent text-gray-500 hover:text-gray-800 hover:border-gray-800 cursor-pointer transition-colors dark:text-gray-600 dark:hover:border-gray-300 dark:hover:text-gray-300"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><rect x="4" y="4" width="16" height="16" rx="2"/><line x1="8" y1="11" x2="8" y2="16"/><line x1="8" y1="8" x2="8" y2="8.01"/><line x1="12" y1="16" x2="12" y2="11"/><path d="M16 16v-3a2 2 0 00-4 0"/></svg></a></li></ul></div></div></main><footer class="container p-6 mx-auto flex justify-between items-center"><span class="text-sm font-light">Copyright © 2024 - Lindsay Shelton · All rights reserved</span>
<span onclick='window.scrollTo({top:0,behavior:"smooth"})' class="p-1 cursor-pointer"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18 15l-6-6-6 6h12"/></svg></span></footer><div class="search-ui absolute top-0 left-0 w-full h-full bg-white dark:bg-gray-800 hidden"><div class="container max-w-3xl mx-auto p-12"><div class=relative><div class="my-4 text-center text-2xl font-bold">Search</div><span class="p-2 absolute right-0 top-0 cursor-pointer close-search"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></span></div><input type=search class="py-2 px-3 w-full dark:text-black border dark:border-transparent" placeholder="Enter search query"><div class="search-results text-lg font-medium my-4 hidden">Results</div><ul class="search-list my-2"></ul><div class="no-results text-center my-8 hidden"><div class="text-xl font-semibold mb-2">No results found</div><p class="font-light text-sm">Try adjusting your search query</p></div></div></div><script src=https://blist.vercel.app/js/scripts.min.js></script>
<script>const darkmode=document.querySelector(".toggle-dark-mode");function toggleDarkMode(){document.documentElement.classList.contains("dark")?(document.documentElement.classList.remove("dark"),localStorage.setItem("darkmode","light")):(document.documentElement.classList.add("dark"),localStorage.setItem("darkmode","dark"))}darkmode&&darkmode.addEventListener("click",toggleDarkMode);const darkStorage=localStorage.getItem("darkmode"),isBrowserDark=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;!darkStorage&&isBrowserDark&&document.documentElement.classList.add("dark"),darkStorage&&darkStorage==="dark"&&toggleDarkMode()</script><script>const mobileMenuButton=document.querySelector(".mobile-menu-button"),mobileMenu=document.querySelector(".mobile-menu");function toggleMenu(){mobileMenu.classList.toggle("hidden"),mobileMenu.classList.toggle("flex")}mobileMenu&&mobileMenuButton&&mobileMenuButton.addEventListener("click",toggleMenu)</script></body></html>